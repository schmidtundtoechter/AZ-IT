[
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Insert",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2025-10-29 09:05:02.851962",
  "module": "Az It",
  "name": "Customer Internal Number Auto Assignment",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Customer",
  "script": "# Server Script for Customer - Auto Generate Internal Customer Number\n# Event: Before Insert\n\n# Only proceed if the internal customer number field is empty\nif not doc.custom_interne_kundennummer:\n    # Get the highest existing customer number >= 20000\n    highest_customer = frappe.db.sql(\"\"\"\n        SELECT custom_interne_kundennummer \n        FROM `tabCustomer` \n        WHERE custom_interne_kundennummer IS NOT NULL \n        AND custom_interne_kundennummer != '' \n        AND CAST(custom_interne_kundennummer AS UNSIGNED) >= 20000\n        ORDER BY CAST(custom_interne_kundennummer AS UNSIGNED) DESC \n        LIMIT 1\n    \"\"\", as_dict=True)\n    \n    # Default starting number\n    next_number = 20000\n    \n    # If we found a highest number, increment it\n    if highest_customer and highest_customer[0].custom_interne_kundennummer:\n        try:\n            current_number = int(highest_customer[0].custom_interne_kundennummer)\n            if current_number >= 20000:\n                next_number = current_number + 1\n        except ValueError:\n            # If conversion fails, use default 20000\n            next_number = 20000\n    \n    # Set the new customer number (exactly 5 characters, padded with zeros)\n    doc.custom_interne_kundennummer = str(next_number).zfill(5)",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Save",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2025-10-29 09:07:22.693443",
  "module": "Az It",
  "name": "Customer Internal Number Auto Assignment - Update",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Customer",
  "script": "# Server Script for Customer - Auto Generate Internal Customer Number on Update\n# Event: Before Save\n\n# Only proceed if the internal customer number field is empty\nif not doc.custom_interne_kundennummer:\n    # Get the highest existing customer number >= 20000\n    highest_customer = frappe.db.sql(\"\"\"\n        SELECT custom_interne_kundennummer \n        FROM `tabCustomer` \n        WHERE custom_interne_kundennummer IS NOT NULL \n        AND custom_interne_kundennummer != '' \n        AND CAST(custom_interne_kundennummer AS UNSIGNED) >= 20000\n        ORDER BY CAST(custom_interne_kundennummer AS UNSIGNED) DESC \n        LIMIT 1\n    \"\"\", as_dict=True)\n    \n    # Default starting number\n    next_number = 20000\n    \n    # If we found a highest number, increment it\n    if highest_customer and highest_customer[0].custom_interne_kundennummer:\n        try:\n            current_number = int(highest_customer[0].custom_interne_kundennummer)\n            if current_number >= 20000:\n                next_number = current_number + 1\n        except ValueError:\n            # If conversion fails, use default 20000\n            next_number = 20000\n    \n    # Set the new customer number (exactly 5 characters, padded with zeros)\n    doc.custom_interne_kundennummer = str(next_number).zfill(5)",
  "script_type": "DocType Event"
 }
]